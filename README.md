# play2Sample

## 目的

JavaでWebサーバーを書くためのひな形を用意する。

## アーキテクチャ

- とにかく副作用を局所化する。
- 設定（application.conf）で実装を差し替える。
- 異常系は例外を投げる。（JavaでEitherとか嫌だから。）
- lombok好き。

## Model

NoSQLがどこで使えるか、差し替え可能に書けるかを試す。

今回の実装ではRDB（H2-mysqlMode）とKVS（DynamoDB）で試す。
理由は準備が楽だから。

### Model1

- 単独データパターン
- 単純なKey-Valueのペア
- ex: tag 

### Model2

- 一対多パターン
- 子が親を知っているデータ構造
- ex: articleとcomment

### Model3

- 多対多パターン
- それぞれ別のモデルが連携し合う場合
- ex: articleとtag

### Model4

- ロック不要パターン
- 一つの値を複数人が更新するが、制約はないので操作履歴を持っておけば良い。
- ex: いいねボタン

### Model5

- ロック必要パターン
- 現在の状態からの相対変化が発生する場合
- ex: お金の増減

### Model6

- Transactionパターン
- 同一でないモデルを同時に操作する必要がある場合
- ex: モノの売買
- 相対的な変化を持つ場合、ロックも必要。

### Model7

- 複数DBパターン
- 異なるDBを単一の処理で更新する場合
- ex: S3のようなファイルサーバ（ファイラとDBを同時に扱う）

### 考察

そもそも

## クライアントサイド

### SinglePageApplication

#### メリット

- サーバー・クライアント間はJsonをやりとりするだけなので粗結合になる。（別々に開発できる。）
- ajaxを駆使することでモダンなUIが作りやすい
- 通信を小分けにできるので、処理がシンプルになる。

#### デメリット

- 一般的にSEOに弱い。
- 古いブラウザに対応するのが難しい。
- ルーティングを上手くやらないと、リンクから飛ぶ使い方がしにくい。
